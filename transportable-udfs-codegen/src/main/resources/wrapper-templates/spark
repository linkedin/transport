package ${wrapperPackage}

import java.util
import com.google.common.collect.ImmutableList
import com.linkedin.transport.api.udf.{UDF, TopLevelUDF}
import com.linkedin.transport.spark.{SparkStdUDF, StdUDFRegistration, StdUdfWrapper}
import org.apache.spark.sql.SparkSession
import org.apache.spark.sql.catalyst.expressions.Expression


case class ${wrapperClass}(expressions: Seq[Expression]) extends StdUdfWrapper(expressions) {

  override protected def getTopLevelUdfClass: Class[_ <: TopLevelUDF] = classOf[${udfTopLevelClass}]

  override protected def getStdUdfImplementations: util.List[_ <: UDF] = ImmutableList.of(
    ${udfImplementations}
  )
}

object ${wrapperClass} {

  def register(name: String): SparkStdUDF = {
    StdUDFRegistration.register(name, classOf[${wrapperClass}])
  }

  def register(name: String, session: SparkSession): SparkStdUDF = {
    StdUDFRegistration.register(name, classOf[${wrapperClass}], session)
  }
}
